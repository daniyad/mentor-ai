{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import MainHeading from\"../components/MainHeading\";import{useNavigate}from\"react-router-dom\";import axios from\"axios\";import ConfirmModal from\"../components/ConfirmModal\";import{deleteTokenAndId}from\"../ts/utils/utils\";import{TOKEN_STORAGE_KEY,ID_STORAGE_KEY,API_URL}from\"../App\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const SettingPage=_ref=>{let{token,id}=_ref;const[username,setUsername]=useState(\"\");const[verified,setVerified]=useState(false);const navigate=useNavigate();const[deleteAccountConfirm,setDeleteAccountConfirm]=useState(false);const deleteAccountFn=()=>{console.log(\"account deleted\");axios.post(\"\".concat(API_URL,\"/api/accounts/delete/\").concat(id),{},{headers:{Authorization:token}}).then(_ref2=>{let{data}=_ref2;if(data.success){deleteTokenAndId(TOKEN_STORAGE_KEY,ID_STORAGE_KEY);navigate(\"/\");window.location.reload();}else{}}).catch(e=>{console.log(e);});};useEffect(()=>{axios.get(\"\".concat(API_URL,\"/api/accounts/id/\").concat(id),{headers:{Authorization:token}}).then(_ref3=>{let{data}=_ref3;setUsername(data.username);setVerified(true);}).catch(e=>{var _e$response;console.log(e);if(((_e$response=e.response)===null||_e$response===void 0?void 0:_e$response.data).success===false){navigate(\"/sorry\");setVerified(false);}});},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[verified?/*#__PURE__*/_jsx(MainHeading,{data:{username:username||\"\",items:[{text:\"Problem List\",link_path:\"/problemset\"}]}}):/*#__PURE__*/_jsx(MainHeading,{data:{status:\"none\"}}),/*#__PURE__*/_jsx(\"div\",{className:\"px-[8px]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-black border border-borders rounded-lg mx-auto justify-center mt-[8px] max-w-[1000px] h-fit px-6 py-2\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"setting-title text-red-600\",children:\"Delete Account\"}),/*#__PURE__*/_jsx(\"p\",{className:\"setting-p\",children:\"This will delete your account permenantly. All data will be lost. There is no going back.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"setting-button-red\",onClick:()=>setDeleteAccountConfirm(true),children:\"Delete your account\"}),/*#__PURE__*/_jsx(ConfirmModal,{display:deleteAccountConfirm,displayFn:setDeleteAccountConfirm,onOkFn:deleteAccountFn,title:\"Delete Account\",message:\"Are you sure you want to delete account \".concat(username,\"?\")}),/*#__PURE__*/_jsx(\"hr\",{className:\"setting-hr\"})]})})]});};export default SettingPage;","map":{"version":3,"names":["React","useEffect","useState","MainHeading","useNavigate","axios","ConfirmModal","deleteTokenAndId","TOKEN_STORAGE_KEY","ID_STORAGE_KEY","API_URL","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SettingPage","_ref","token","id","username","setUsername","verified","setVerified","navigate","deleteAccountConfirm","setDeleteAccountConfirm","deleteAccountFn","console","log","post","concat","headers","Authorization","then","_ref2","data","success","window","location","reload","catch","e","get","_ref3","_e$response","response","children","items","text","link_path","status","className","onClick","display","displayFn","onOkFn","title","message"],"sources":["/Users/EL-CAPITAN-2016/Development/mentor/client/src/pages/SettingPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport MainHeading from \"../components/MainHeading\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport axios, { AxiosError } from \"axios\";\r\nimport ConfirmModal from \"../components/ConfirmModal\";\r\nimport { deleteTokenAndId } from \"../ts/utils/utils\";\r\nimport { TOKEN_STORAGE_KEY, ID_STORAGE_KEY, API_URL } from \"../App\";\r\n\r\nconst SettingPage = ({\r\n    token,\r\n    id,\r\n}: {\r\n    token: string | null;\r\n    id: string | null;\r\n}) => {\r\n    const [username, setUsername] = useState<string>(\"\");\r\n    const [verified, setVerified] = useState<boolean>(false);\r\n    const navigate = useNavigate();\r\n\r\n    const [deleteAccountConfirm, setDeleteAccountConfirm] =\r\n        useState<boolean>(false);\r\n\r\n    const deleteAccountFn = () => {\r\n        console.log(\"account deleted\");\r\n        axios\r\n            .post(\r\n                `${API_URL}/api/accounts/delete/${id}`,\r\n                {},\r\n                {\r\n                    headers: {\r\n                        Authorization: token,\r\n                    },\r\n                }\r\n            )\r\n            .then(({ data }) => {\r\n                if (data.success) {\r\n                    deleteTokenAndId(TOKEN_STORAGE_KEY, ID_STORAGE_KEY);\r\n                    navigate(\"/\");\r\n                    window.location.reload();\r\n                } else {\r\n                }\r\n            })\r\n            .catch((e) => {\r\n                console.log(e);\r\n            });\r\n    };\r\n\r\n    useEffect(() => {\r\n        axios\r\n            .get(`${API_URL}/api/accounts/id/${id}`, {\r\n                headers: {\r\n                    Authorization: token,\r\n                },\r\n            })\r\n            .then(({ data }) => {\r\n                setUsername(data.username);\r\n                setVerified(true);\r\n            })\r\n            .catch((e: AxiosError) => {\r\n                console.log(e);\r\n                if (\r\n                    (e.response?.data as { success: boolean; message: string })\r\n                        .success === false\r\n                ) {\r\n                    navigate(\"/sorry\");\r\n                    setVerified(false);\r\n                }\r\n            });\r\n    }, []);\r\n    return (\r\n        <>\r\n            {verified ? (\r\n                <MainHeading\r\n                    data={{\r\n                        username: username || \"\",\r\n                        items: [\r\n                            {\r\n                                text: \"Problem List\",\r\n                                link_path: \"/problemset\",\r\n                            },\r\n                        ],\r\n                    }}\r\n                />\r\n            ) : (\r\n                <MainHeading data={{ status: \"none\" }} />\r\n            )}\r\n            <div className=\"px-[8px]\">\r\n                <div className=\"bg-black border border-borders rounded-lg mx-auto justify-center mt-[8px] max-w-[1000px] h-fit px-6 py-2\">\r\n                    <h1 className=\"setting-title text-red-600\">\r\n                        Delete Account\r\n                    </h1>\r\n                    <p className=\"setting-p\">\r\n                        This will delete your account permenantly. All data will\r\n                        be lost. There is no going back.\r\n                    </p>\r\n                    <button\r\n                        className=\"setting-button-red\"\r\n                        onClick={() => setDeleteAccountConfirm(true)}\r\n                    >\r\n                        Delete your account\r\n                    </button>\r\n                    <ConfirmModal\r\n                        display={deleteAccountConfirm}\r\n                        displayFn={setDeleteAccountConfirm}\r\n                        onOkFn={deleteAccountFn}\r\n                        title=\"Delete Account\"\r\n                        message={`Are you sure you want to delete account ${username}?`}\r\n                    />\r\n                    <hr className=\"setting-hr\" />\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default SettingPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}